This code doesn't work correctly so I had to write entirely new codes again , as I was unable to find the errors.